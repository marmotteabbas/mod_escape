define(["jquery","mod_escape/leaflet"],function(a,b){var c;return{init:function(){if(""!==a("input[name=location]").val())var d=a("input[name=location]").val().replace("[","").replace("]",""),e=d.split(",");else var e=[45.17235628126675,5.767478942871095];c=b.map("mapid").setView([e[0],e[1]],13),b.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1}).addTo(c),""!==a("input[name=location]").val()&&(b.marker([e[0],e[1]]).addTo(c).bindPopup("Stage Place").openPopup(),a("input[name='location']").val("["+e[0]+","+e[1]+"]")),c.on("click",this.onMapClick)},onMapClick:function(d){a(".leaflet-marker-icon").remove(),a(".leaflet-popup").remove(),a(".leaflet-shadow-pane").remove(),b.marker([d.latlng.lat,d.latlng.lng]).addTo(c).bindPopup("Stage Place").openPopup(),a("input[name='location']").val("["+d.latlng.lat+","+d.latlng.lng+"]")}}});