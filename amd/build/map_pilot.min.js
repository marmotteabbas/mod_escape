define(["jquery","mod_escape/leaflet"],function(e,a){var t;return{init:function(){if(""!==e("input[name=location]").val())var o=e("input[name=location]").val().replace("[","").replace("]","").split(",");else o=[45.17235628126675,5.767478942871095];t=a.map("mapid").setView([o[0],o[1]],13),a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1}).addTo(t),""!==e("input[name=location]").val()&&(a.marker([o[0],o[1]]).addTo(t).bindPopup("Stage Place").openPopup(),e("input[name='location']").val("["+o[0]+","+o[1]+"]")),t.on("click",this.onMapClick)},onMapClick:function(o){e(".leaflet-marker-icon").remove(),e(".leaflet-popup").remove(),e(".leaflet-shadow-pane").remove(),a.marker([o.latlng.lat,o.latlng.lng]).addTo(t).bindPopup("Stage Place").openPopup(),e("input[name='location']").val("["+o.latlng.lat+","+o.latlng.lng+"]")},clearMarkers:function(){e(".leaflet-marker-icon").remove(),e(".leaflet-popup").remove(),e(".leaflet-shadow-pane").remove(),e("input[name='location']").val("")}}});